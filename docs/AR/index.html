
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Scanner - Water level monitor</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        #table-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 999;
            perspective: 1000px;
        }

        #table-data {
            color: white;
            font-size: 24px;
            border: 2px solid white;
            border-collapse: collapse;
            transform: rotateX(20deg);
            transform-origin: center;
        }

        #table-data th, #table-data td {
            border: 2px solid white;
            padding: 10px;
        }
    </style>
    <script src="https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
    <script type="text/javascript">
        let scanner = new Instascan.Scanner({ video: document.getElementById('qr-video'), mirror: false });
        let isTableVisible = false;

        // Function to show the table overlay
        function showTableOverlay() {
            const overlay = document.getElementById('table-overlay');
            overlay.style.display = 'flex';
            setTimeout(() => {
                overlay.style.transform = 'rotateX(0deg)';
            }, 10);
        }

        // Function to hide the table overlay
        function hideTableOverlay() {
            const overlay = document.getElementById('table-overlay');
            overlay.style.display = 'none';
            overlay.style.transform = 'rotateX(20deg)';
        }

        // Function to resume scanning when "New Scan" button is clicked
        function resumeScanning() {
            hideTableOverlay();
            isTableVisible = false;
            scanner.start();
        }

        // ... (your existing JavaScript code)

        // Function to start the camera
        function startCamera() {
            Instascan.Camera.getCameras().then(function (cameras) {
                if (cameras.length > 0) {
                    scanner.start(cameras[0]); // Use the first available camera
                } else {
                    console.error('No cameras found.');
                }
            }).catch(function (e) {
                console.error('Error accessing camera: ' + e);
            });
        }

        // Event listener for QR code scan
        scanner.addListener('scan', function (content) {
            document.getElementById('qr-result').textContent = "QR Code Detected: " + content;
            showTableOverlay();
            isTableVisible = true;
            // Add your logic for loading data and updating the table here
        });

        // Start the camera when the page loads
        window.onload = startCamera;
    </script>
</head>
<body>
    <h3>Scan QR code on Water level monitor's web interface</h3>
    <video id="qr-video" style="width: 100%; height: auto;" autoplay></video>
    <canvas id="qr-canvas" style="display: none;"></canvas>
    <div id="qr-result" style="margin-top: 20px;"></div>
    <!-- New div to show the table -->
    <div id="table-overlay">
        <table id="table-data">
            <tr>
                <th>Attribute</th>
                <th>Value</th>
            </tr>
            <tr>
                <td>Height:</td>
                <td id="height-value"></td>
            </tr>
            <tr>
                <td>Volume:</td>
                <td id="volume-value"></td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <button onclick="resumeScanning()">New Scan</button>
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
